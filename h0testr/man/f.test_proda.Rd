% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/test.R
\name{f.test_proda}
\alias{f.test_proda}
\title{Hypothesis testing using the \code{proDA} package}
\usage{
f.test_proda(
  state,
  config,
  is_log_transformed = NULL,
  prior_df = 3,
  maxit = 20
)
}
\arguments{
\item{state}{List with elements like those returned by \code{f.read_data()}:
\tabular{ll}{
  \code{expression} \cr \tab Numeric matrix with non-negative expression values. \cr
  \code{features}   \cr \tab A data.frame with feature meta-data for rows of expression. \cr
  \code{samples}    \cr \tab A data.frame with observation meta-data for columns of expression. \cr
}}

\item{config}{List with configuration values. Uses the following keys:
\tabular{ll}{
  \code{gene_id_col}    \cr \tab Name of column in \code{state$features} with unique gene/protein group ids. \cr
  \code{feat_col}       \cr \tab Name of column in \code{state$features} corresponding to \code{rownames(state$expression)}. \cr
  \code{obs_col}        \cr \tab Name of column in \code{state$samples} corresponding to \code{colnames(state$expression)}. \cr
  \code{frm}            \cr \tab Formula (formula) to be fit \cr
  \code{test_term}      \cr \tab Term (character) to be tested for non-zero coefficient. \cr
  \code{norm_method}    \cr \tab If present and \code{is_log_transformed} unset, used to infer it. \cr
}}

\item{is_log_transformed}{Logical scalar indicating if \code{state$expression} has been log transformed.}

\item{prior_df}{Strictly positive count (\code{location_prior_df}) indicating number of dfs for prior.}

\item{maxit}{Strictly positive count indicating maximum number of iterations for \code{proDA::proDA()} algorithm.}
}
\value{
A data.frame with test results. Columns include \code{config$gene_id_col} and: 
    \code{c("nNonZero .n", "logFC", "se", "df", "t", "pval", "adjPval")}.
}
\description{
Tests for differential expression using the \code{proDA::proDA()} function.
}
\details{
Uses the \code{proDA::proDA()} function. Returned results sorted by p-value.
  See documentation for \code{h0testr::f.new_config()} 
    for more detailed description of configuration parameters.
}
\examples{
## lengthy setup of expression data:
set.seed(101)
nsamps <- 6
sim <- h0testr::f.sim2(
  n_samps1=nsamps, n_samps2=nsamps, n_genes=100, n_genes_signif=20, 
  fold_change=1, peps_per_gene=10, reps_per_sample=1, 
  p_drop=0.33, mnar_c0=-Inf, mnar_c1=0, mcar_p=0
)
exprs <- sim$mat
gene <- strsplit(rownames(exprs), "_")
gene <- sapply(gene, function(v) unlist(v)[1])
feats <- data.frame(pep=rownames(exprs), gene=gene)
samps <- data.frame(
  obs=colnames(exprs), 
  grp=c(rep("ctl", nsamps), rep("trt", nsamps)),
  sex=rep(c("M", "F"), round(ncol(exprs) / 2))
)
state <- list(expression=exprs, features=feats, samples=samps)
rm(sim, exprs, gene, feats, samps)

## setup config and prep variables of interest for testing:
config <- list(
  obs_id_col="obs",
  sample_id_col="obs",
  feat_id_col="pep",
  gene_id_col="gene",
  frm=~grp+sex+grp:sex, 
  test_term="grp",
  sample_factors=list( 
    grp=c("ctl", "trt"), 
    sex=c("F", "M")
  )
)
out <- h0testr::f.initialize(state, config, minimal=TRUE)

## actual test:
tbl <- h0testr::f.test_proda(out$state, out$config, is_log_transformed=FALSE)
head(tbl)
}
